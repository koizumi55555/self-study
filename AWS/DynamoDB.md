## DynamoDB

#### 概要

- フルマネージド、3つのAZにまたがるレプリケーションに よる高可用性
- NoSQLデータベース - リレーショナルデータベースではない
- 大規模ワークロードや分散型データベースへの対応
- 毎秒数百万のリクエスト、 数兆のデータ、 数百 TBのストレージ 高速で安定したパフォーマンス (検索時のレイテンシーが少ない) IAM との統合により、セキュリティ、認証、管理を実現
- DynamoDB Streams によるイベントドリブンなプログラミングを実現 低コストとオートスケーリング機能
- テーブルのアイテムの最大サイズは400KB
- サポートされているデータタイプ:
  スカラータイプ：文字列、 数値、 バイナリ、 ブーリアン、 Null
  ドキュメントタイプ: リスト、マップ
  集合タイプ (Set Types): 文字列セット、 数値セット、 バイナリセット

#### プロビジョンスループット

- テーブルには、プロビジョニングされた「リードキャパシティユニット」・「ライトキャパシティユニット」が必要
- リードキャパシティユニット (RCU) 読み取りスループット (RCUあたり$0.00013)
  - IRCU=1秒間に1回の強い整合性のある読み取り (1回の読み取りで4KBまで)
  - IRCU=1秒間に2回の結果整合性のある読み取り(1回の読み取りで4KBまで)
- ライトキャパシティユニット (WCU) 書き込みスループット (WCUあたり$0.00065)
  - IWCU=1 秒間に IKB の書き込みが可能
- 需要に応じたスループットの自動スケーリングを設定可能 ( オプション )
- スループットを一時的に超えることができる “バーストクレジット”がある
- バーストクレジットが空の場合は、「ProvisionedThroughputException」が発生

#### DAX

- DAX = DynamoDB Accelerator
- DynamoDB のシームレスなキャッシュ、アプリケーションの書き換え不要
- 書込みはDAXを経由してDynamoDBへ
- キャッシュされたリードとクエリーのレイテンシー はマイクロ秒
- ホットキーの問題を解決(特定キーの読み込み過多)
- デフォルトではキャッシュの TTL が5分
- クラスター内で最大 10 ノード
- マルチ AZ (本番環境では最低3ノードを推奨) ・セキュア (KMS によるキャッシュデータの暗号化、 VPC、IAM、CloudTrail)

#### Streams

- DynamoDBでの変更(Create, Update, Delete)を、DynamoDB Streamに流せる
- ストリームをAWS Lambdaで読み込んで、下記のことも可能
  - リアルタイムに変化に対応する(新規ユーザーへのウェルカムメール)
  - アナリティクス
  - 派生テーブル/ビューの作成
  - ElasticSearchへの挿入
- Streams を使って別リージョンにレプリケーションを作る事も可能

#### トランザクション

- オール・オア・ナッシング型のオペレーション
- 複数のテーブルへの挿入、更新、削除を、Iトランザクションとして扱うことが可能(どれかが失敗したら、他の操作が取り消される)
- 最大 10 個のユニークアイテムまたは最大 4MB のデータまで

#### オンデマンド

- キャパシティプランニングが不要 (WCU/RCU)自動的に拡張可能
- プロビジョニングされた容量と比較して2.5倍の価格 (利用時は注意)
- スパイクが予測できない場合や、アプリケーションのスループットが非常に低い場合に有効

#### セキュリティ

- インターネットを経由せずに DynamoDB にアクセスできる VPC エンドポイント
- IAM による完全なアクセス制御
- KMS を利用したデータの暗号化
- SSL/TLS による通信路の暗号化

#### その他機能

- バックアップ&リストア機能
  - RDS のようなポイント・イン・タイム・リストア
  - パフォーマンスに影響なし
- グローバルテーブル
  - マルチリージョン、フルレプリケーション、ハイパフォーマンス
- Amazon DMS: DynamoDBへの移行(Mongo, Oracle, MySQL, S3などから)
- ローカル DynamoDB: 開発用に自分のコンピュータでローカルのDynamoDBを立ち上げ
- グローバルテーブル(クロスリージョンでの複製)
  - アクティブなレプリケーション、
  - 多くのリージョンで利用可能
  - DynamoDB Streams が必要
  - 低レイテンシー、 DR目的に有効
- キャパシティプランニング
  - プロビジョンドキャパシティ: WCUとRCUのプロビジョニング、オートスケーリングが可能
  - オンデマンドキャパシティ: WCUとRCUを無制限に利用可能、スロットルなし、価格は高い
